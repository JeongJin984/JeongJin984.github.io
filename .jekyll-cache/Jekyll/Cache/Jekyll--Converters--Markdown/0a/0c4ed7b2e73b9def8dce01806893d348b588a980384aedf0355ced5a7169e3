I"[\<h1 id="java-annotation">Java Annotation</h1>
<hr />

<h2 id="-annotation">ğŸ”˜ Annotation</h2>

<ol>
  <li>ì–´ë…¸í…Œì´ì…˜ì˜ ì—­í• ë„ ì£¼ì„ê³¼ í¬ê²Œ ë‹¤ë¥´ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ì¼ë°˜ì£¼ì„ê³¼ í° ì°¨ì´ì ì€ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ ë‹¤ë¥´ë‹¤.</li>
  <li>ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì€ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë­”ê°€ë¥¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ ëœë‹¤.</li>
  <li>ì–´ë…¸í…Œì´ì…˜ë„ enumê³¼ ë§ˆì°¬ê°€ì§€ë¡œ 1.5ì— ë“±ì¥í–ˆë‹¤ê³  í•œë‹¤.</li>
</ol>

<hr />
<h2 id="-annotation-ì¢…ë¥˜">ğŸ”˜ Annotation ì¢…ë¥˜</h2>

<ol>
  <li>@Retention
    <ul>
      <li>ìë°” ì»´íŒŒì¼ëŸ¬ê°€ ì–´ë…¸í…Œì´ì…˜ì„ ë‹¤ë£¨ëŠ” ë°©ë²•ì„ ê¸°ìˆ í•˜ë©°, íŠ¹ì • ì‹œì ê¹Œì§€ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ë¥¼ ê²°ì •</li>
      <li>RetentionPolicy.SOURCE: ì»´íŒŒì¼ ì „ê¹Œì§€ë§Œ ìœ íš¨(ì»´íŒŒì¼ì‹œ ì‚¬ë¼ì§)</li>
      <li>RetentionPolicy.CLASS: ì»´íŒŒì¼ëŸ¬ê°€ í´ë˜ìŠ¤ë¥¼ ì°¸ì¡°í•  ë•Œê¹Œì§€ ìœ íš¨(ë°”ì´íŠ¸ì½”ë“œì—ëŠ” ì¡´ì¬)</li>
      <li>RetentionPolicy.RUNTIME: ì»´íŒŒì¼ ì´íœ´ì—ë„ JVMì— ì˜í•´ ê³„ì† ì°¸ì¡°ê°€ ê°€ëŠ¥(ë¦¬í”Œë ‰ì…˜ ì‚¬ìš© ê°€ëŠ¥)</li>
    </ul>
  </li>
  <li>Target
    <ul>
      <li>ì–´ë…¸í…Œì´ì…˜ì´ ì ìš©ë  ìœ„ì¹˜ë¥¼ ì„ íƒ</li>
      <li>ElementType.PACKAGE: íŒ¨í‚¤ì§€ì— ì„ ì–¸</li>
      <li>ElementType.TYPE: íƒ€ì… ì„ ì–¸</li>
      <li>ElementType.ANNOTAION_TYPE: ì–´ë…¸í…Œì´ì…˜ íƒ€ì… ì„ ì–¸</li>
      <li>ElementType.CONSTRUCTOR: ìƒì„±ì ì„ ì–¸</li>
      <li>ElementType.FIELD: ë©¤ë²„ ë³€ìˆ˜ ì„ ì–¸</li>
      <li>ElementType.LOCAL_VARIBALE: ì§€ì—­ë³€ìˆ˜ ì„ ì–¸</li>
      <li>ElementType.METHOD: ë©”ì„œë“œ ì„ ì–¸</li>
      <li>ElementType.PARAMETER: ì „ë‹¬ì¸ì ì„ ì–¸</li>
      <li>ElementType.TYPE_PARAMETER: ì „ë‹¬ì¸ì íƒ€ì… ì„ ì–¸</li>
      <li>ElementType.TYPE_USE: íƒ€ì… ì„ ì–¸</li>
    </ul>
  </li>
  <li>Documented
    <ul>
      <li>í•´ë‹¹ Annotationì„ JavaDocì— í¬í•¨ì‹œí‚µë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Inherited
    <ul>
      <li>Annotaion ìƒì†ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>@Repeatable
    <ul>
      <li>Java8 ë¶€í„° ì§€ì›í•˜ë©° ì—°ì†ì ìœ¼ë¡œ ì–´ë…¸í…Œì´ì…˜ì„ ì„ ì–¸í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ol>

<hr />
<h2 id="-annotation-ì •ì˜í•˜ê¸°">ğŸ”˜ Annotation ì •ì˜í•˜ê¸°</h2>

<p>âœ”ï¸ <strong>ì •ìˆ˜ ê°’ ì£¼ì…í•˜ê¸°</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">InsertIntData</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">data</span><span class="o">()</span> <span class="k">default</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AnnotationExam01</span> <span class="o">{</span>
    <span class="nd">@InsertIntData</span><span class="o">(</span><span class="n">data</span> <span class="o">=</span> <span class="mi">30</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">myAge</span><span class="o">;</span>

    <span class="nd">@InsertIntData</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">defaultAge</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">AnnotationExam01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">myAge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">defaultAge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getMyAge</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">myAge</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getDefaultAge</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">defaultAge</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>myAgeì— ì–´ë…¸í…Œì´ì…˜ì—ì„œëŠ” 30ìœ¼ë¡œ ê°’ì„ ì£¼ì…í•©ë‹ˆë‹¤.</li>
  <li>defaultAge ì—ì„œëŠ” ê°’ì´ ì—†ëŠ”ë° ì´ ê²½ìš° ì–´ë…¸í…Œì´ì…˜ì—ì„œ ì •í•œ ê¸°ë³¸ ê°’ì¸ 0ìœ¼ë¡œ ê°’ì´ ì£¼ì…ì´ ë©ë‹ˆë‹¤.</li>
  <li>ìƒì„±ìì˜ ê²½ìš° ê°’ì´ ì—†ì„ ê²½ìš° -1ì„ ê¸°ë³¸ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.</li>
</ul>

<hr />

<h2 id="-annotation-processor">ğŸ”˜ Annotation Processor</h2>

<blockquote>
  <p>Annotation Processorë¥¼ ì´ìš©í•˜ì—¬ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì†ŒìŠ¤ë¥¼ ì¡°ì‘</p>
</blockquote>

<ul>
  <li>Annotation Processorê°€ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ëª¨ë“  ì†ŒìŠ¤ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë©°, ìƒˆë¡œ ì‘ì„±ë˜ëŠ” íŒŒì¼ì—ë§Œ ì†ŒìŠ¤ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆê³  ê¸°ì¡´ì— ìˆë˜ íŒŒì¼ë“¤ì€ ê±´ë“œë¦´ ìˆ˜ ì—†ë‹¤ê³  í•œë‹¤.</li>
  <li>Lombokì€ ëœë‹¤ê³  í•œë‹¤.</li>
</ul>

<hr />

<h2 id="-annotation-processsor-ë™ì‘">ğŸ”˜ Annotation Processsor ë™ì‘</h2>

<p>Annotation ProcessorëŠ” ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•´ì„œ ìˆ˜í–‰ëœë‹¤.(ë¼ìš´ë“œì— ê¸°ì´ˆí•˜ì—¬)
ê° ë¼ìš´ë“œëŠ” ì»´íŒŒì¼ëŸ¬ê°€ ì–´ë…¸í…Œì´ì…˜ì„ ê²€ìƒ‰í•˜ê³ , í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì— ë§ëŠ” Processorë¥¼ ì„ íƒí•˜ëŠ” ê²ƒ ë¶€í„° ì‹œì‘ëœë‹¤.</p>

<blockquote>
  <p>If any files are generated during this process, another round is started with the generated files as its input. This process continues until no new files are generated during the processing stage.</p>
</blockquote>

<p>Annotation Processor ë˜í•œ JVM ìœ„ì—ì„œ ëŒì•„ê°€ë¯€ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ë§Œë“  Processorë¥¼ .jar íŒŒì¼ë¡œ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ë° ì´ë ‡ê²Œ ì••ì¶•í•  ë•Œ META-INF/services ì•ˆì— ìˆëŠ” Processorë¥¼ ê°™ì´ ì••ì¶•í•´ì¤˜ì•¼ í•œë‹¤.(googleì˜ auto-serviceë¥¼ ì‚¬ìš©í•˜ë©´ ì•Œì•„ì„œ í•´ì¤€ë‹¤.)</p>

<hr />

<h2 id="-annotation-processsor-ì‚¬ìš©">ğŸ”˜ Annotation Processsor ì‚¬ìš©</h2>

<p>ëª¨ë“  í”„ë¡œì„¸ì„œë“¤ì€ AbstractProcessorë¥¼ ìƒì†ë°›ì•„ì•¼ í•œë‹¤.</p>

<p>âœ”ï¸ ì¶”ìƒë©”ì„œë“œ process()</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span>
 <span class="nc">Set</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">TypeElement</span><span class="o">&gt;</span> <span class="n">annotations</span><span class="o">,</span> <span class="nc">RoundEnvironment</span> <span class="n">roundEnv</span>
<span class="o">);</span>

<span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">ProcessingEnvironment</span> <span class="n">processingEnv</span><span class="o">)</span>

<span class="kd">public</span> <span class="nc">SourceVersion</span> <span class="nf">getSupportedSourceVersion</span><span class="o">()</span>

<span class="kd">public</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getSupportedAnnotationTypes</span><span class="o">()</span>

<span class="kd">public</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getSupportedOptions</span><span class="o">()</span>

<span class="kd">public</span> <span class="nc">Iterable</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Completion</span><span class="o">&gt;</span> <span class="nf">getCompletions</span><span class="o">(...)</span>

<span class="kd">protected</span> <span class="kd">synchronized</span> <span class="kt">boolean</span> <span class="nf">isInitialized</span><span class="o">()</span>

<span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">arrayToSet</span><span class="o">(...)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>process(): ê° í”„ë¡œì„¸ì„œì˜ main ë©”ì„œë“œì™€ ê°™ì€ ì—­í•  ì´ ë©”ì„œë“œì—ì„œ ì›í•˜ëŠ” ë™ì‘ì„ ì½”ë“œë¡œ ì‘ì„±</li>
  <li>getSupportedAnnotationTypes(): ì²˜ë¦¬í•  Annotationì„ ëª…ì‹œ ì´ ë©”ì„œë“œëŠ” Annotationì„ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.</li>
  <li>getSupportedSourceVersion(): íŠ¹ì • ìë°”ë²„ì „ì„ ëª…ì‹œí•˜ëŠ”ë° ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° Annotationì„ ëŒ€ì²´ í•  ìˆ˜ ìˆë‹¤.
    <ul>
      <li>Annotationì—ì„œëŠ” SourceVersion.latestSupported()ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê³  íŠ¹ì • ë²„ì „ì„ ëª…ì‹œí•´ì¤˜ì•¼ í•œë‹¤ëŠ” ì ì´ ë‹¤ë¥´ë‹¤.</li>
    </ul>
  </li>
  <li>init(ProcessingEnvironment processingEnvironment): ëª¨ë“  Annotation ProcessorëŠ” ê¸°ë³¸ ìƒì„±ìë¥¼ ê°€ì ¸ì•¼ í•œë‹¤. ëŒ€ì‹  init ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë° processingEnvironmentì—ì„œ Utilì„ ì œê³µí•œë‹¤.
    <ol>
      <li>Types typeUtils = processingEnvironment.getTypeUtils();</li>
      <li>Elements elementUtils = processingEnvironment.getElementUtils();</li>
      <li>Filer filer = processingEnvironment.getFiler();</li>
      <li>Messager messager = processingEnvironment.getMessager();</li>
    </ol>
  </li>
</ul>

<hr />

<h2 id="-poet-ë¼ì´ë¸ŒëŸ¬ë¦¬">ğŸ”˜ Poet ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>

<blockquote>
  <p>JAVA ì†ŒìŠ¤ íŒŒì¼ì„ ìƒì„±í•˜ê¸° ìœ„í•œ JAVA API</p>
</blockquote>

<p>âœ”ï¸ <strong>Hello World ë§Œë“¤ê¸°</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nc">MethodSpec</span> <span class="n">main</span> <span class="o">=</span> <span class="nc">MethodSpec</span><span class="o">.</span><span class="na">methodBuilder</span><span class="o">(</span><span class="s">"main"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">addModifiers</span><span class="o">(</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">PUBLIC</span><span class="o">,</span> <span class="nc">Modifier</span><span class="o">.</span><span class="na">STATIC</span><span class="o">)</span>
    <span class="o">.</span><span class="na">returns</span><span class="o">(</span><span class="kt">void</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">.</span><span class="na">addParameter</span><span class="o">(</span><span class="nc">String</span><span class="o">[].</span><span class="na">class</span><span class="o">,</span> <span class="s">"args"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">addStatement</span><span class="o">(</span><span class="s">"$T.out.println($S)"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"Hello, JavaPoet!"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="nc">TypeSpec</span> <span class="n">helloWorld</span> <span class="o">=</span> <span class="nc">TypeSpec</span><span class="o">.</span><span class="na">classBuilder</span><span class="o">(</span><span class="s">"HelloWorld"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">addModifiers</span><span class="o">(</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">PUBLIC</span><span class="o">,</span> <span class="nc">Modifier</span><span class="o">.</span><span class="na">FINAL</span><span class="o">)</span>
    <span class="o">.</span><span class="na">addMethod</span><span class="o">(</span><span class="n">main</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="nc">JavaFile</span> <span class="n">javaFile</span> <span class="o">=</span> <span class="nc">JavaFile</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"com.example.helloworld"</span><span class="o">,</span> <span class="n">helloWorld</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">javaFile</span><span class="o">.</span><span class="na">writeTo</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
   <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Hello World!"</span> <span class="o">);</span>
   <span class="nc">HelloWorldPoet</span> <span class="n">poet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HelloWorldPoet</span><span class="o">();</span>
   <span class="n">poet</span><span class="o">.</span><span class="na">generatedHelloWorld</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>writeTo(): ì…ë ¥ëœ PATHì— íŒŒì¼ì´ ìƒì„±ë¨()</li>
</ul>

<hr />

<h2 id="-lombock">ğŸ”˜ Lombock</h2>

<blockquote>
  <p>í‘œì¤€ì ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•  ì½”ë“¤ë¥´ ê°œë°œì ëŒ€ì‹  ìƒì„±í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬</p>
</blockquote>

<ul>
  <li>ì»´íŒŒì¼ ì‹œì ì— Annotation Processorë¥¼ ì‚¬ìš©í•˜ì—¬ ì†ŒìŠ¤ì½”ë“œì˜ AST(abstract syntax tree)ë¥¼ ì¡°ì‘í•œë‹¤.</li>
</ul>

<p>âœ”ï¸ <strong>BUT</strong></p>
<ol>
  <li>ê³µê°œëœ APIê°€ ì•„ë‹Œ ì»´íŒŒì¼ëŸ¬ ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì¡°ì‘í•œë‹¤.</li>
  <li>Eclipseì˜ ê²½ìš° java agentë¥¼ ì‚¬ìš©í•˜ì—¬ ì»´íŒŒì¼ëŸ¬ í´ë˜ìŠ¤ê¹Œì§€ ì¡°ì‘í•˜ì—¬ ì‚¬ìš©. í•´ë‹¹ í´ë˜ìŠ¤ë“¤ ì—­ì‹œ ê³µê°œëœ APIê°€ ì•„ë‹ˆë¯€ë¡œ ë²„ì „ í˜¸í™˜ì„±ì— ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.</li>
</ol>

<hr />

<h2 id="annotation-processor-ì‹¤ìŠµ">Annotation Processor ì‹¤ìŠµ</h2>

<p>âœ”ï¸ <strong>Factory ë§Œë“¤ê¸°</strong></p>

<ol>
  <li>magic Annotation ìƒì„±</li>
  <li>AbstractProcessorë¥¼ ìƒì†í•˜ì—¬ customProcessorë¥¼ ìƒì„±</li>
  <li>process(Set&lt;&gt; annotations, RoundEnvironment roundEnv) ì‘ì„±</li>
</ol>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span>
    <span class="nc">Set</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">TypeElemnet</span><span class="o">&gt;</span> <span class="n">annotations</span><span class="o">,</span> 
    <span class="nc">RoundEnvironment</span> <span class="n">roundEnv</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">roundEnv</span><span class="o">.</span><span class="na">getElementAnnotatedWith</span><span class="o">(</span><span class="nc">Magic</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
         
        <span class="k">for</span><span class="o">(</span><span class="nc">Element</span> <span class="n">element</span> <span class="o">:</span> <span class="n">elements</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Name</span> <span class="n">simpleName</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">();</span>
            <span class="k">if</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">getKind</span><span class="o">()</span> <span class="o">!=</span> <span class="nc">ElementKind</span><span class="o">.</span><span class="na">INTERFACE</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">processingEnv</span><span class="o">.</span><span class="na">getMessager</span><span class="o">().</span><span class="na">printMessage</span><span class="o">(</span><span class="nc">Diagnostic</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="s">"ERROR"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">processingEnv</span><span class="o">.</span><span class="na">getMessager</span><span class="o">().</span><span class="na">printMessage</span><span class="o">(</span><span class="nc">Diagnostic</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">NOTE</span><span class="o">,</span> <span class="s">"name: "</span> <span class="o">+</span> <span class="n">simpleName</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="nc">TypeElement</span> <span class="n">typeElement</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TypeElement</span><span class="o">)</span><span class="n">element</span><span class="o">;</span>
        <span class="nc">ClassName</span> <span class="n">className</span> <span class="o">=</span> <span class="nc">ClassName</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">typeElement</span><span class="o">);</span>

        <span class="nc">MethodSpec</span> <span class="n">pullOut</span> <span class="o">=</span> <span class="nc">MethodSpec</span><span class="o">.</span><span class="na">methodBuilder</span><span class="o">(</span><span class="s">"pullOut"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addModifiers</span><span class="o">(</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">PUBLIC</span><span class="o">);</span>
            <span class="o">.</span><span class="na">returns</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addStatement</span><span class="o">(</span><span class="s">"return $s"</span><span class="o">,</span> <span class="s">"Rabbits!"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">TypeSpec</span> <span class="nc">MagicMoja</span> <span class="o">=</span> <span class="nc">TypeSpec</span><span class="o">.</span><span class="na">classBuilder</span><span class="o">(</span><span class="s">"MagicMoja"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addModifiers</span><span class="o">(</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">PUBLIC</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addSuperinterface</span><span class="o">(</span><span class="n">className</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addMethod</span><span class="o">(</span><span class="n">pullOut</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">Filter</span> <span class="n">filter</span> <span class="o">=</span> <span class="n">processsingEnv</span><span class="o">.</span><span class="na">getFilter</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">JavaFile</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">className</span><span class="o">.</span><span class="na">packageName</span><span class="o">(),</span> <span class="n">magicMoja</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
                <span class="o">.</span><span class="na">writeTo</span><span class="o">(</span><span class="n">filter</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">processingEnv</span><span class="o">.</span><span class="na">getMessager</span><span class="o">().</span><span class="na">printMessage</span><span class="o">(</span><span class="nc">Diagnostic</span><span class="o">.</span><span class="na">Kind</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="s">"ERROR"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<ol>
  <li>META-INF.servicesì— javax.annotation.processing.Processorì— ë§Œë“  Processorì˜ í’€íŒ¨í‚¤ì§€ ê²½ë¡œë¥¼ ì…ë ¥(Processorë¥¼ ë“±ë¡)
    <ul>
      <li>Processorê°€ ë§Œë“¤ì–´ì§€ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë¹Œë“œë¥¼ í•˜ê¸° ë•Œë¬¸ì— ë¹Œë“œí•˜ê³  ì‘ì„±í•´ì•¼í•¨</li>
      <li>ì•„ë‹ˆë©´ auto-Serviceë¥¼ ì‚¬ìš©í•˜ì</li>
    </ul>
  </li>
  <li>ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì— ë§Œë“  Processorì˜ ì˜ì¡´ì„±ì„ ì£¼ì…í•œë‹¤.</li>
  <li>ì†ŒìŠ¤ì½”ë“œ ê²½ë¡œë¥¼ ì¶”ê°€í•´ ì¤€ë‹¤.</li>
  <li></li>
</ol>
:ET