<!DOCTYPE html><html lang="ko" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Spring-JPA-Entity" /><meta name="author" content="Jiny" /><meta property="og:locale" content="ko" /><meta name="description" content="Spring JPA" /><meta property="og:description" content="Spring JPA" /><link rel="canonical" href="https://jeongjin984.github.io/posts/Spring-JPA-Entity/" /><meta property="og:url" content="https://jeongjin984.github.io/posts/Spring-JPA-Entity/" /><meta property="og:site_name" content="Jiny" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-01T14:09:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Spring-JPA-Entity" /><meta name="twitter:site" content="@None" /><meta name="twitter:creator" content="@Jiny" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"https://jeongjin984.github.io/posts/Spring-JPA-Entity/","headline":"Spring-JPA-Entity","dateModified":"2021-06-06T17:31:31+09:00","datePublished":"2021-02-01T14:09:00+09:00","author":{"@type":"Person","name":"Jiny"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jeongjin984.github.io/posts/Spring-JPA-Entity/"},"description":"Spring JPA","@context":"https://schema.org"}</script><title>Spring-JPA-Entity | Jiny</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Jiny"><meta name="application-name" content="Jiny"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://pixy.org/src/474/thumbs350/4749768.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Jiny</a></div><div class="site-subtitle font-italic">Lifes are vicious</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/JeongJin984" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/None" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['philipwq12','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Spring-JPA-Entity</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Spring-JPA-Entity</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Jiny </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 1, 2021, 2:09 PM +0900" prep="on" > Feb 1, 2021 <i class="unloaded">2021-02-01T14:09:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jun 6, 2021, 5:31 PM +0900" prefix="Updated " > Jun 6, 2021 <i class="unloaded">2021-06-06T17:31:31+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="390 words">2 min</span></div></div><div class="post-content"><h1 id="spring-jpa">Spring JPA</h1><hr /><h2 id="entity-설계시-주의사항">Entity 설계시 주의사항</h2><p><strong>🔘 Entity에는 가급적 Setter를 사용하지 말자</strong></p><ul><li>변경 포인트가 많아서 유지보수가 어렵다.</ul><p><strong>🔘 모든 연관관계는 LAZY(지연) LOADING으로 설정</strong></p><ul><li>Eager(즉시) Loading은 예측이 어렵고 어떤 SQL이 실행 될지 추적하기가 어렵다.<ul><li>특히 JPQL을 실행하면 N+1 문제가 자주 발생한다.(select o from object)(무조건 같이 로딩되기 때문에)</ul><li>연관된 Entity를 함께 DB에 조회해야 한다면, fetch join 또는 Entity Graph를 사용한다.<li>OnetoOne, ManyToOne 관계는 기본이 즉시로딩이므로 직접 지연로딩으로 설정</ul><p><strong>🔘 컬렉션은 필드에서 초기화 하자</strong></p><ul><li>null 문제에서 안전하다<li>Hibernate는 Entity를 영속화 할 떄 컬렉션을 감싸서 Hibernate가 제공하는 내장 컬렉션으로 변경<ul><li>만약 getOrders()처럼 임의의 메서드에서 컬렉션을 잘못 생성하면 내부 메커니즘에 문제가 발생할 수 있다.</ul></ul><p><strong>🔘 테이블 컬럼명 생성 전략</strong></p><ul><li>Hibernate 기본전략: Entity의 필드명을 그대로 테이블 명으로 사용(SpringPhysicalNamingStrategy)<li>Spring Boot 신규 설정<ol><li>카멜 케이스 → 언더스코어(memberPoint → member_point)<li>.(점) → _(언더스코어)<li>대문자 → 소문자</ol></ul><p><strong>🔘 Cascade 옵션</strong></p><ul><li>영속성 상태를 전파 시키는 옵션<li>List에 들어가는 모든 객체를 따로 영속화 할 필요없이 자동으로 영속화</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>Java</a>, <a href='/categories/spring/'>Spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a> <a href="/tags/jpa/" class="post-tag no-text-decoration" >jpa</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Spring-JPA-Entity - Jiny&url=https://jeongjin984.github.io/posts/Spring-JPA-Entity/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Spring-JPA-Entity - Jiny&u=https://jeongjin984.github.io/posts/Spring-JPA-Entity/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Spring-JPA-Entity - Jiny&url=https://jeongjin984.github.io/posts/Spring-JPA-Entity/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/OSI-Layer/">OSI Layer</a><li><a href="/posts/JVM/">JVM</a><li><a href="/posts/java-Basics/">Java-Basics</a><li><a href="/posts/JavaType/">Java-Types</a><li><a href="/posts/Java-DataStructure/">Java-DataStructure</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/dl/">dl</a> <a class="post-tag" href="/tags/infra/">infra</a> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Spring-JPA/"><div class="card-body"> <span class="timeago small" > Jan 24, 2021 <i class="unloaded">2021-01-24T18:16:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring JPA</h3><div class="text-muted small"><p> Spring JPA 💿 JPA 자바 어플리케이션에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스 여기서 주목할 점은 바로 인터페이스라는 것이다. JPA는 특정 기능을 하는 라이브러리가 아니다. JPA는 자바 어플리케이션에서 관계형 데이터베이스를 어떻게 사용해야 하는지를 정의한 방법이다. JPA는 단순히 interface이...</p></div></div></a></div><div class="card"> <a href="/posts/Spring-JPA-2/"><div class="card-body"> <span class="timeago small" > Jan 24, 2021 <i class="unloaded">2021-01-24T18:16:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring JPA 2</h3><div class="text-muted small"><p> Spring JPA 2 💿 Entity Mapping @Entity Entity는 객체 관점에서 부르는 이름 보통 Class와 같은 이름을 사용하기 때문에 값을 변경하지 않음 Entity의 이름은 JQL에서 사용 @Table Relation(database) 관점에서 부르는 이름 @Entity의 이름이 기본값 Ta...</p></div></div></a></div><div class="card"> <a href="/posts/Spring-JPA-3/"><div class="card-body"> <span class="timeago small" > Mar 6, 2021 <i class="unloaded">2021-03-06T18:16:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring JPA 3</h3><div class="text-muted small"><p> Spring JPA 3 💿 Fetch Join &amp; EAGER &amp; LAZY 즉시 로딩(EARGR로 설정) 멤버 전체를 조회하기 위해 JPQL 실행 select m from member m JPQL은 EAGER와 무관하게 SQL로 그대로 번역 -&gt; select m.* from member JPQL 결과가 member...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SQL-Basic/" class="btn btn-outline-primary" prompt="Older"><p>SQL Basic</p></a> <a href="/posts/Java-IO/" class="btn btn-outline-primary" prompt="Newer"><p>Java IO</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Nam Jeong Jin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/dl/">dl</a> <a class="post-tag" href="/tags/infra/">infra</a> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://JeongJin984.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
