<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Spring JPA 2" /><meta name="author" content="Jiny" /><meta property="og:locale" content="en_US" /><meta name="description" content="Spring JPA 2" /><meta property="og:description" content="Spring JPA 2" /><link rel="canonical" href="https://jeongjin984.github.io/posts/Spring-JPA-2/" /><meta property="og:url" content="https://jeongjin984.github.io/posts/Spring-JPA-2/" /><meta property="og:site_name" content="Jiny" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-24T18:16:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Spring JPA 2" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Jiny" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","datePublished":"2021-01-24T18:16:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jeongjin984.github.io/posts/Spring-JPA-2/"},"url":"https://jeongjin984.github.io/posts/Spring-JPA-2/","author":{"@type":"Person","name":"Jiny"},"description":"Spring JPA 2","headline":"Spring JPA 2","dateModified":"2021-03-09T19:25:45+09:00","@context":"https://schema.org"}</script><title>Spring JPA 2 | Jiny</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Jiny</a></div><div class="site-subtitle font-italic">Lifes are vicious</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/JeongJin984" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Spring JPA 2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Spring JPA 2</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 24, 2021, 6:16 PM +0900" > Jan 24 <i class="unloaded">2021-01-24T18:16:00+09:00</i> </span> by <span class="author"> Jiny </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 9, 2021, 7:25 PM +0900" > Mar 9 <i class="unloaded">2021-03-09T19:25:45+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="608 words">3 min</span></div></div><div class="post-content"><h1 id="spring-jpa-2">Spring JPA 2</h1><hr /><h2 id="-entity-mapping">💿 Entity Mapping</h2><h3 id="entity">@Entity</h3><ul><li>Entity는 객체 관점에서 부르는 이름<li>보통 Class와 같은 이름을 사용하기 때문에 값을 변경하지 않음<li>Entity의 이름은 JQL에서 사용</ul><h3 id="table">@Table</h3><ul><li>Relation(database) 관점에서 부르는 이름<li>@Entity의 이름이 기본값<li>Table의 이름은 SQL에서 사용</ul><h3 id="id">@Id</h3><ul><li>Entity의 Primary Key를 매핑할 떄 사용<li>java의 모든 primitive 와 Wrapper 타입 사용 가능<ul><li>Date랑 BigDecimal, BigInteger도 사용가능</ul><li>복합키를 만들어 매핑하는 방법도 있긴 있음</ul><h3 id="generativevalue">@GenerativeValue</h3><ul><li>Primary Key의 생성 방법을 매핑하는 Annotation<li>생성 전략과 생성기를 생성할 수 있음<ul><li>기본 전략: AUTO(DB에 따라 적절한 전략 선택)<li>TABLE, SEQUENCE, IDENTITY 중 하나</ul></ul><h3 id="column">@Column</h3><ul><li>unique, nullable, length, ColumnDefinition 등 Row의 특성 정의</ul><h3 id="temporal">@Temporal</h3><ul><li>Date 와 Calendar</ul><h3 id="transient">@Transient</h3><ul><li>Column으로 매핑하고 싶지 않은 멤버 변수에 사용</ul><p><strong>Tip</strong></p><ul><li>spring.jpa.show-sql=true<li>spring.jpa.properties.hibernate.format_sql=true</ul><hr /><h2 id="-value-타입-매핑">💿 @Value 타입 매핑</h2><h3 id="entity-와-value">Entity 와 Value</h3><ul><li>식별자가 있어야 하는가<li>독립적으로 존재해야 하는가</ul><h3 id="value-타입-종류">Value 타입 종류</h3><ul><li>기본 타입(String, Date, Boolean)<li>Composite Value 타입<li>Collection Value 타입<ul><li>기본 타입의 콜렉션<li>Composite 타입의 콜렉션</ul></ul><h3 id="composite-value-타입">Composite Value 타입</h3><ul><li>@Embedable<li>@Embedded<li>@AttributeOverrides<li>AttributeOverride</ul><hr /><h2 id="-관계-매핑">💿 관계 매핑</h2><ul><li>2개의 Entity의 관계를 설정<ul><li>둘 중 하나는 관계의 주인이 되어야 함<li>다른 쪽은 종속된 쪽<li>해당 관계의 반대쪽 레퍼런스를 가진 쪽이 주인</ul><li>단방향<ul><li>단방향에서는 관계의 주인이 명확<ul><li>관계를 정의한 쪽이 관계의 주인</ul><li>단방향 @ManyToOne<ul><li>기본값은 FK 생성</ul><li>단방향 @OneToMany<ul><li>기본값은 조인 테이블 생성</ul></ul><li>양방향<ul><li>FK를 가지고 있는 쪽이 Owner 따라서 @ManytoOne 가지고 있는 쪽이 주인<li>주인이 아닌 쪽은 mappedby를 통해 필드를 설정<ul><li>@ManyToOne(이쪽이 주인)<li>@OneToMany(mappedby)<li>주인에게 관계를 설정해야 DB에 반영이 됨(중요)<ul><li>mappedby쪽에 더해서 save해도 DB 적용 안됨</ul></ul></ul></ul><hr /><h2 id="-entity-상태와-cascade">💿 Entity 상태와 Cascade</h2><blockquote><p>Cascade: Entity의 상태를 전이 시키는 옵션</p></blockquote><h3 id="entity의-상태">Entity의 상태</h3><ul><li>Transient: JPA가 모르는 상태<li>Persistent: JPA가 관리중인 상태(1차 캐쉬, Dirty-Checking, WriteBehind)<li>Detached: JPA가 더이상 관리하지 않는 상태<li>Removed: JPA가 관리하긴 하지만 삭제하기로 한 상태</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://blog.kakaocdn.net/dn/biYa6T/btqCuYYCtXY/Bxqa5rHj3s4Rz33PQDmJFK/img.jpg" alt="image" /></p><hr /><h2 id="entity-fetch-join">Entity Fetch Join</h2><ul><li>연관된 Entity를 함께 조회<li>select m from Member m join fetch m.team<ul><li>SQL: Select M.<em>,T.</em> FROM MEMBER M INNER JOIN TEAM T on M.TEAM_ID=T.ID</ul></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>Java</a>, <a href='/categories/spring/'>Spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a> <a href="/tags/jpa/" class="post-tag no-text-decoration" >jpa</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Spring JPA 2 - Jiny&url=https://JeongJin984.github.io/posts/Spring-JPA-2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Spring JPA 2 - Jiny&u=https://JeongJin984.github.io/posts/Spring-JPA-2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Spring JPA 2 - Jiny&url=https://JeongJin984.github.io/posts/Spring-JPA-2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Spring-JPA-3/">Spring JPA 3</a><li><a href="/posts/Spring-JPA-2/">Spring JPA 2</a><li><a href="/posts/Java-Annotation/">Spring</a><li><a href="/posts/Java-Generic/">Java Generic</a><li><a href="/posts/Spring-JPA-Querydsl/">Spring-JPA-Querydsl</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/dl/">dl</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/computerarchitecture/">computerarchitecture</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/springmvc/">springmvc</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Spring-JPA-3/"><div class="card-body"> <span class="timeago small" > Mar 6 <i class="unloaded">2021-03-06T18:16:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring JPA 3</h3><div class="text-muted small"><p> Spring JPA 3 💿 Fetch Join &amp; EAGER &amp; LAZY 즉시 로딩(EARGR로 설정) 멤버 전체를 조회하기 위해 JPQL 실행 select m from member m JPQL은 EAGER와 무관하게 SQL로 그대로 번역 -&gt; select m.* from member JPQL 결과가 member...</p></div></div></a></div><div class="card"> <a href="/posts/Spring-Spring-QueryDsl/"><div class="card-body"> <span class="timeago small" > Mar 22 <i class="unloaded">2021-03-22T21:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring QueryDsl</h3><div class="text-muted small"><p> Spring QueryDsl 💿 기본 문법 기본 검색 Query 1 2 3 4 5 Memer findMember = queryFactory .selectFrom(member) .where(member.username.eq("member1") .and(member.age.eq(10))) ...</p></div></div></a></div><div class="card"> <a href="/posts/Spring-JPA/"><div class="card-body"> <span class="timeago small" > Jan 24 <i class="unloaded">2021-01-24T18:16:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring JPA</h3><div class="text-muted small"><p> Spring JPA 💿 JPA 자바 어플리케이션에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스 여기서 주목할 점은 바로 인터페이스라는 것이다. JPA는 특정 기능을 하는 라이브러리가 아니다. JPA는 자바 어플리케이션에서 관계형 데이터베이스를 어떻게 사용해야 하는지를 정의한 방법이다. JPA는 단순히 interface이...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2021-KAKAO-BLIND-RECRUITMENT-1/" class="btn btn-outline-primary"><p>Spring JPA</p></a> <a href="/posts/2021-KAKAO-BLIND-RECRUITMENT-2/" class="btn btn-outline-primary"><p>Spring JPA</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/dl/">dl</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/computerarchitecture/">computerarchitecture</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/springmvc/">springmvc</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://JeongJin984.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
