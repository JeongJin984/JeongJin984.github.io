<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.0"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Java Thread" /><meta name="author" content="Jiny" /><meta property="og:locale" content="en_US" /><meta name="description" content="Java Thread" /><meta property="og:description" content="Java Thread" /><link rel="canonical" href="https://jeongjin984.github.io/posts/Java-Thread/" /><meta property="og:url" content="https://jeongjin984.github.io/posts/Java-Thread/" /><meta property="og:site_name" content="Jiny" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-22T23:40:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Java Thread" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Jiny" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"https://jeongjin984.github.io/posts/Java-Thread/","headline":"Java Thread","dateModified":"2021-02-11T10:46:45+09:00","datePublished":"2021-01-22T23:40:00+09:00","author":{"@type":"Person","name":"Jiny"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jeongjin984.github.io/posts/Java-Thread/"},"description":"Java Thread","@context":"https://schema.org"}</script><title>Java Thread | Jiny</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Jiny</a></div><div class="site-subtitle font-italic">Lifes are vicious</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/JeongJin984" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Java Thread</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Java Thread</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 22, 2021, 11:40 PM +0900" > Jan 22 <i class="unloaded">2021-01-22T23:40:00+09:00</i> </span> by <span class="author"> Jiny </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 11, 2021, 10:46 AM +0900" > Feb 11 <i class="unloaded">2021-02-11T10:46:45+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2381 words">13 min</span></div></div><div class="post-content"><h1 id="java-thread">Java Thread</h1><hr /><h2 id="-thread-lifecycle">💿 Thread LifeCycle</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://miro.medium.com/max/700/1*Dfl8EQlWdIebwAh9UinLMA.jpeg" alt="image" /></p><ul><li>New: Thread.start() 하면 실행됨<li>Runnable: start하면 runnable로 바뀜<ul><li>Control이 Thread Scheduler로 가서 실행을 기다림</ul><li>Running: Scheduler가 실행을 시킨 상태<li>Blocked<ul><li>Waiting for I/O resources<li>Waiting for a monitor lock</ul><li>Waiting: 다른 Thread가 특정 action을 perform하길 기다리는 상태<ul><li>Object.wait with no timeout<li>Thread.join with no timeout<li>예를 들어 Object.wait()를 특정 object에 호출한 후 다른 쓰레드가 Object.notify or Object.notifyAll()를 그 Object에 호출하기를 기다리는 상태<li>waiting이 끝나면 Runnable로 돌아감</ul><li>Timed_Waiting: 밑의 함수를 호출 해서 waiting 상태<ul><li>Thread.sleep<li>Object.wait with timeout<li>Thread.join with timeout</ul><li>Terminated: run()이 끝나면 자원을 반납하고 종료</ul><hr /><h2 id="-thread-생성자">💿 Thread 생성자</h2><div class="table-wrapper"><table><thead><tr><th>함수<th>설명<tbody><tr><td>Thread()<td>스레드 이름<tr><td>Thread(Runnable r)<td>인터페이스 객체<tr><td>Thread(Runnable r, String s)<td>인터페이스 객체와 스레드 이름</table></div><hr /><h2 id="-thread-method">💿 Thread Method</h2><div class="table-wrapper"><table><thead><tr><th>함수<th>설명<tbody><tr><td>static void sleep(long msec)<br /> throws Interrupted Exception<td>msec에 지정된 밀리초 동안 대기<tr><td>String getName()<td>스레드의 이름을 s로 설정<tr><td>void setName(String s)<td>스레드의 이름을 s로 설정<tr><td>void start()<td>스레드를 시작 run() 메소드 호출<tr><td>int getPriority()<td>스레드의 우선 순위를 반환<tr><td>void setpriority(int p)<td>스레드의 우선순위를 p값으로<tr><td>boolean isAlive()<td>스레드가 시작되었고 아직 끝나지 않았으면 <br />true 끝났으면 false 반환<tr><td>void join() <br /> throws InterruptedException<td>스레드가 끝날 때 까지 대기<tr><td>void run()<td>스레드가 실행할 부분 기술<br /> (오버라이딩 사용)<tr><td>void suspend()<td>스레드가 일시정지 resume()에 <br />의해 다시시작 할 수 있다.<tr><td>void resume()<td>일시 정지된 스레드를 다시 시작.<tr><td>void yield()<td>다른 스레드에게 실행 상태를 양보하고 <br />자신은 준비 상태로</table></div><hr /><h2 id="-thread-생성">💿 Thread 생성</h2><h3 id="extend-thread">extend Thread</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">seq</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Test</span><span class="o">(</span><span class="kt">int</span> <span class="n">seq</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">seq</span> <span class="o">=</span> <span class="n">seq</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">seq</span><span class="o">+</span><span class="s">" thread start."</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">seq</span><span class="o">+</span><span class="s">" thread end."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Test</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"main end."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>output</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>0 thread start.
4 thread start.
6 thread start.
2 thread start.
main end.
3 thread start.
...
1 thread end.
5 thread end.
</pre></table></code></div></div><ul><li>특징<ul><li>test.start() 실행 시 test객체의 run 메소드가 수행<li>쓰레드가 종료되기 전에 main 메소드가 종료</ul></ul><hr /><h3 id="-join">💿 Join</h3><blockquote><p>쓰레드가 종료될 때까지 기다리게 하는 메서드</p></blockquote><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Thread</span><span class="o">&gt;</span> <span class="n">threads</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Thread</span><span class="o">&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="nc">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Test</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="n">t</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">threads</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">threads</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="nc">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="n">threads</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">t</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"main end."</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>output</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0 thread start.
5 thread start.
2 thread start.
6 thread start.
...
main end.
</pre></table></code></div></div><ul><li>특징<ul><li>모든 쓰레드가 종료된 후에 main 메소드를 종료</ul></ul><h3 id="-runnable">💿 Runnable</h3><blockquote><p>흔히 사용되는 방법</p></blockquote><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">seq</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Test</span><span class="o">(</span><span class="kt">int</span> <span class="n">seq</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">seq</span> <span class="o">=</span> <span class="n">seq</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">seq</span><span class="o">+</span><span class="s">" thread start."</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">seq</span><span class="o">+</span><span class="s">" thread end."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Thread</span><span class="o">&gt;</span> <span class="n">threads</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Thread</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="k">new</span> <span class="nc">Test</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
            <span class="n">t</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
            <span class="n">threads</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">threads</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="n">threads</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">t</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
            <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"main end."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>특징<ul><li>Thread t = new Thread(new Test(i));</ul></ul><hr /><h2 id="-thread-우선순위">💿 Thread 우선순위</h2><blockquote><p>우선순위라는 속성(멤버변수)의 값에 따라 쓰레드가 얻는 실행시간이 달라짐</p></blockquote><ul><li>쓰레드가 수행하는 작업의 중요도에 따라 쓰레드의 우선순위를 서로 다르게 지정하여 특정 쓰레드가 더 많은 작업시간을 갖도록 할 수 있다</ul><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">ThreadPriority</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>

		<span class="no">A</span> <span class="n">th1</span> <span class="o">=</span> <span class="k">new</span> <span class="no">A</span><span class="o">();</span>
		<span class="no">B</span> <span class="n">th2</span> <span class="o">=</span> <span class="k">new</span> <span class="no">B</span><span class="o">();</span>

		<span class="n">th1</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span> <span class="c1">// defalut 우선순위 5</span>
		<span class="n">th2</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>

		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Priority of th1(-): "</span> <span class="o">+</span> <span class="n">th1</span><span class="o">.</span><span class="na">getPriority</span><span class="o">());</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Priority of th2(|): "</span> <span class="o">+</span> <span class="n">th2</span><span class="o">.</span><span class="na">getPriority</span><span class="o">());</span>

		<span class="n">th1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
		<span class="n">th2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

	<span class="o">}</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">A</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"-"</span><span class="o">);</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">10000000</span><span class="o">;</span> <span class="n">x</span><span class="o">++);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">B</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"|"</span><span class="o">);</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">10000000</span><span class="o">;</span> <span class="n">x</span><span class="o">++);</span>
		<span class="o">}</span>
	<span class="o">}</span>	
<span class="o">}</span>
</pre></table></code></div></div><p>우선순위가 높은 th2의 실행시간이 th1에 비해 상당히 늘어난다.</p><hr /><h2 id="-main-쓰레드">💿 Main 쓰레드</h2><blockquote><p>메인이 수행하는 스레드 public static void main(String[] args)</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://2.bp.blogspot.com/-LR5DRGuoL1g/Wa-KoLJVdvI/AAAAAAAABTQ/8Fl2OhPww6MtTkxxqpNCYmUWv1-Ftan0QCLcBGAs/s1600/main-thread-in-java.jpeg" alt="image" /></p><ul><li>The main thread is created automatically when our program is started</ul><h3 id="main-thread-controll">Main Thread Controll</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

	<span class="c1">// getting reference to Main thread</span>
	<span class="nc">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">();</span>
  
	<span class="c1">// getting name of Main thread</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Current thread: "</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
  
	<span class="c1">// changing the name of Main thread</span>
	<span class="n">t</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"Geeks"</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After name change: "</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
  
	<span class="c1">// getting priority of Main thread</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Main thread priority: "</span><span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getPriority</span><span class="o">());</span>
  
	<span class="c1">// setting priority of Main thread to MAX(10)</span>
	<span class="n">t</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="no">MAX_PRIORITY</span><span class="o">);</span>
  
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Main thread new priority: "</span><span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getPriority</span><span class="o">());</span>
  
	<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Main thread"</span><span class="o">);</span>
	<span class="o">}</span>
  
	<span class="c1">// Main thread creating a child thread</span>
	<span class="nc">ChildThread</span> <span class="n">ct</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ChildThread</span><span class="o">();</span>

	<span class="c1">// getting priority of child thread</span>
	<span class="c1">// which will be inherited from Main thread</span>
	<span class="c1">// as it is created by Main thread</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Child thread priority: "</span><span class="o">+</span> <span class="n">ct</span><span class="o">.</span><span class="na">getPriority</span><span class="o">());</span>

	<span class="c1">// setting priority of Main thread to MIN(1)</span>
	<span class="n">ct</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="no">MIN_PRIORITY</span><span class="o">);</span>

	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Child thread new priority: "</span><span class="o">+</span> <span class="n">ct</span><span class="o">.</span><span class="na">getPriority</span><span class="o">());</span>

	<span class="c1">// starting child thread</span>
	<span class="n">ct</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Child Thread class</span>
<span class="kd">class</span> <span class="nc">ChildThread</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Child thread"</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>output</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Current thread: main
After name change: Geeks
Main thread priority: 5
Main thread new priority: 10
Main thread
Main thread
Child thread priority: 10
Child thread new priority: 1
Child thread
Child thread
</pre></table></code></div></div><h2 id="동기화">동기화</h2><h3 id="synchronized를-이용한-동기화">Synchronized를 이용한 동기화</h3><p><strong>객체에 lock을 걸고자 할 때</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">synchronized</span><span class="o">(</span><span class="n">객체의</span> <span class="n">참조변수</span><span class="o">){</span>

<span class="c1">//.....</span>

<span class="o">}</span>
</pre></table></code></div></div><p><strong>method에 lock을 걸고자 할 때</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">calcSum</span><span class="o">(){</span>

<span class="c1">//.....</span>

<span class="o">}</span>
</pre></table></code></div></div><ul><li>함수에 synchronized를 걸면 그 함수가 포함된 해당 객체(this)에 lock을 거는것</ul><p><strong>Example</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">ThreadEx24</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>

		<span class="nc">Runnable</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="no">A</span><span class="o">();</span>
		<span class="nc">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
		<span class="nc">Thread</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>

		<span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
		<span class="n">t2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Account</span> <span class="o">{</span>
	<span class="kt">int</span> <span class="n">balance</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
	<span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">withdraw</span><span class="o">(</span><span class="kt">int</span> <span class="n">money</span><span class="o">){</span> <span class="c1">//synchronized 키워드를 붙이기만 하면 간단히 동기화가 된다.</span>

		<span class="k">if</span><span class="o">(</span><span class="n">balance</span> <span class="o">&gt;=</span> <span class="n">money</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>
			<span class="n">balance</span> <span class="o">-=</span> <span class="n">money</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span> <span class="c1">// withdraw</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">A</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

	<span class="nc">Account</span> <span class="n">acc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">();</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>

		<span class="k">while</span><span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">balance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// 100, 200, 300중의 한 값을 임으로 선택해서 출금(withdraw)</span>

			<span class="kt">int</span> <span class="n">money</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)(</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">*</span> <span class="mi">100</span><span class="o">;</span>
			<span class="n">acc</span><span class="o">.</span><span class="na">withdraw</span><span class="o">(</span><span class="n">money</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"balance:"</span><span class="o">+</span><span class="n">acc</span><span class="o">.</span><span class="na">balance</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span> <span class="c1">// run()</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>Synchronized를 사용하지 않으면 예상치 못한 결과가 나온다</ul><h2 id="deadlock">DeadLock</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://blog.kakaocdn.net/dn/bjfUnK/btqyCLopZ7W/WlLoGnKCiE9ur8IbJiKOw0/img.png" alt="imgae" /></p><blockquote><p>임계영역: 둘 이상의 쓰레드가 동시에 실행될 경우 생길 수 있는 동시 접근 문제를 발생시킬 수 있는 코드 블록(Critical Section)</p></blockquote><ul><li>Thread1이 A의 임계영역(test1)에 진입 후 임계영역에서 탈출 하지 않은 채 B의 임계영역(test2)에 진입<ul><li>B에 지입한 상황에선 A는 Lock을 획득해 Blocked 상태<li>Thread2가 임계영역(test1) 진입 한 상태이므로 BLOCKED 됨<ul><li>Thread2가 test1을 통해 ObectA의 test2에 진입하려 하지만 Lock이 풀리지 않았으며 BLOCKED</ul></ul></ul><p>결과적으로 2개의 Thread가 서로 LOCK을 해제하기를 기다리므로 영원히 BLOCKED 됨</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeadLockTest</span> <span class="o">{</span> 

    <span class="nd">@Test</span> 
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">runDeadLock</span><span class="o">()</span> <span class="o">{</span> 

        <span class="nc">Shared</span> <span class="n">s1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Shared</span><span class="o">();</span> 
        <span class="nc">Shared</span> <span class="n">s2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Shared</span><span class="o">();</span> 

        <span class="nc">ExecutorService</span> <span class="n">es</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span> 

        <span class="nc">Future</span><span class="o">&lt;?&gt;</span> <span class="n">future1</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Task</span><span class="o">(</span><span class="n">s1</span><span class="o">,</span> <span class="n">s2</span><span class="o">));</span> 
        <span class="nc">Future</span><span class="o">&lt;?&gt;</span> <span class="n">future2</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Task</span><span class="o">(</span><span class="n">s2</span><span class="o">,</span> <span class="n">s1</span><span class="o">));</span> 

        <span class="n">es</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span> 

        <span class="k">try</span> <span class="o">{</span> 
            <span class="kt">int</span> <span class="n">awaitCnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 

            <span class="k">while</span> <span class="o">(!</span><span class="n">es</span><span class="o">.</span><span class="na">awaitTermination</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">))</span> <span class="o">{</span> 

                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Not a terminate threads. "</span><span class="o">);</span> 

                <span class="n">reportDeadLockThread</span><span class="o">();</span> 

                <span class="n">awaitCnt</span><span class="o">++;</span>

                <span class="k">if</span> <span class="o">(</span> <span class="n">awaitCnt</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">future1</span><span class="o">.</span><span class="na">isCancelled</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">future2</span><span class="o">.</span>   <span class="nf">isCancelled</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span> 
                    <span class="c1">// (4)</span>
                    <span class="n">future1</span><span class="o">.</span><span class="na">cancel</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span> 
                    <span class="n">future2</span><span class="o">.</span><span class="na">cancel</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span> 
                <span class="o">}</span> 
            <span class="o">}</span> 
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> 
            <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">interrupt</span><span class="o">();</span> 
        <span class="o">}</span> 
    <span class="o">}</span> 

    <span class="c1">// (5) </span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">reportDeadLockThread</span><span class="o">()</span> <span class="o">{</span> 

        <span class="nc">ThreadMXBean</span> <span class="n">bean</span> <span class="o">=</span> <span class="nc">ManagementFactory</span><span class="o">.</span><span class="na">getThreadMXBean</span><span class="o">();</span> <span class="c1">// Returns null if no threads are deadlocked. </span>

        <span class="kt">long</span><span class="o">[]</span> <span class="n">threadIds</span> <span class="o">=</span> <span class="n">bean</span><span class="o">.</span><span class="na">findDeadlockedThreads</span><span class="o">();</span> 

        <span class="k">if</span> <span class="o">(</span><span class="n">threadIds</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> 
            <span class="nc">ThreadInfo</span><span class="o">[]</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">bean</span><span class="o">.</span><span class="na">getThreadInfo</span><span class="o">(</span><span class="n">threadIds</span><span class="o">);</span> 
            <span class="k">for</span> <span class="o">(</span><span class="nc">ThreadInfo</span> <span class="n">info</span> <span class="o">:</span> <span class="n">infos</span><span class="o">)</span> <span class="o">{</span> 
                <span class="nc">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="na">getThreadName</span><span class="o">();</span> 
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"DeadLocked Thread Name &gt;&gt;&gt;&gt; %s"</span><span class="o">,</span> <span class="n">s</span><span class="o">));</span> 
            <span class="o">}</span> 
        <span class="o">}</span> 
    <span class="o">}</span> 
    
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Shared</span> <span class="o">{</span> 
        <span class="c1">// (1) </span>
        <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">(</span><span class="nc">Shared</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span> 
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"test1-begin"</span><span class="o">);</span> 
            
            <span class="nc">ThreadUtil</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span> 

            <span class="c1">// (2) </span>
            <span class="n">s2</span><span class="o">.</span><span class="na">test2</span><span class="o">(</span><span class="k">this</span><span class="o">);</span> 

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"test1-end"</span><span class="o">);</span> 
        <span class="o">}</span> 

        <span class="c1">// (3) </span>
        <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">(</span><span class="nc">Shared</span> <span class="n">s1</span><span class="o">)</span> <span class="o">{</span> 
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"test2-begin"</span><span class="o">);</span> 

            <span class="nc">ThreadUtil</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span> 

            <span class="c1">// taking object lock of s1 enters </span>
            <span class="c1">// into test1 method </span>
            <span class="n">s1</span><span class="o">.</span><span class="na">test1</span><span class="o">(</span><span class="k">this</span><span class="o">);</span> 

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"test2-end"</span><span class="o">);</span> 
        <span class="o">}</span> 
    <span class="o">}</span> 
    
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Task</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span> 
        <span class="kd">private</span> <span class="nc">Shared</span> <span class="n">s1</span><span class="o">;</span> 
        <span class="kd">private</span> <span class="nc">Shared</span> <span class="n">s2</span><span class="o">;</span> 
        <span class="c1">// constructor to initialize fields </span>
        <span class="nc">Task</span><span class="o">(</span><span class="nc">Shared</span> <span class="n">s1</span><span class="o">,</span> <span class="nc">Shared</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span> 
            <span class="k">this</span><span class="o">.</span><span class="na">s1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">;</span> 
            <span class="k">this</span><span class="o">.</span><span class="na">s2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">;</span> 
        <span class="o">}</span> 
        <span class="c1">// run method to start a thread </span>
        <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> 
            <span class="c1">// taking object lock of s1 enters </span>
            <span class="c1">// into test1 method </span>
            <span class="n">s1</span><span class="o">.</span><span class="na">test1</span><span class="o">(</span><span class="n">s2</span><span class="o">);</span> 
        <span class="o">}</span> 
    <span class="o">}</span> 
<span class="o">}</span>
</pre></table></code></div></div><ol><li>runDeadLock 함수를 통해서 thread 1, thread 2가 거의 동시에 시작<ul><li>각 thread는 test1() 함수의 실행을 시작한다.<li>this의 동기화 블럭이 시작되면서 자연스레 Lock객체를 공유하는 test2()도 Lock이 걸린다.</ul><li>다른객체 즉 s2객체의 test2() 함수를 호출한다.<ul><li>다른 thread도 동시에 출발 했기 때문에 이 함수는 이미 Lock이 걸려서 이 호출 thread는 이 지점에서 BLOCKED 된다.<li>test2() 함수가 synchronized가 선언되지 않았다면 Thread2에서 test1을 통해 test2를 실행사고 Lock이 풀려 s1 객체도 정상 실행 되었을 것이다.</ul><li>해당 thread를 cancel을 했다. 그러나 아무 효과가 없다.<ul><li>암묵적인 Lock이 BLOCKED 되면 중단시킬 방법이 없기 때문이다.</ul></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>Java</a>, <a href='/categories/jasic/'>Jasic</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/basic/" class="post-tag no-text-decoration" >basic</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Java Thread - Jiny&url=https://JeongJin984.github.io/posts/Java-Thread/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Java Thread - Jiny&u=https://JeongJin984.github.io/posts/Java-Thread/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Java Thread - Jiny&url=https://JeongJin984.github.io/posts/Java-Thread/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Operation-System-2-process-2/">Operation System 2 process 2</a><li><a href="/posts/Operation-System-2-process-3/">Operation System 2 process 3</a><li><a href="/posts/Operation-System-2-process-4/">Operation System 2 process 4</a><li><a href="/posts/Computer-Architecture-1/">Computer Architecure 1</a><li><a href="/posts/Computer-Architecture-2/">Computer Architecure 2</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/dl/">dl</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/process/">process</a> <a class="post-tag" href="/tags/computerarchitecture/">computerarchitecture</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Java-Interface/"><div class="card-body"> <span class="timeago small" > Jan 9 <i class="unloaded">2021-01-09T14:09:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java Interface</h3><div class="text-muted small"><p> Java Interface Interface 자바의 다형성을 극대화하여 개발코드 수정을 줄이고 프로그램 유지보수성을 높이기 위해 인터페이스를 사용 Interface 정의 public interface 인터페이스명 { //상수 타입 상수명 = 값; //추상 메소드 타입 메소드명(매개변수, ... ); //디폴트 메소드 defaul...</p></div></div></a></div><div class="card"> <a href="/posts/Java-Exception/"><div class="card-body"> <span class="timeago small" > Jan 16 <i class="unloaded">2021-01-16T12:48:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java Exception</h3><div class="text-muted small"><p> Java Exception 목차 자바에서 예외 처리 방법 (try, catch, throw, throws, finally) 자바가 제공하는 예외 계층 구조 Exception과 Error의 차이는? RuntimeException과 RE가 아닌 것의 차이는? 커스텀한 예외 만드는 방법 예외(Exception)와 에러(Error)...</p></div></div></a></div><div class="card"> <a href="/posts/Thread-Process/"><div class="card-body"> <span class="timeago small" > Jan 22 <i class="unloaded">2021-01-22T23:40:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Thread Process</h3><div class="text-muted small"><p> Thread Process 💿 Definition 프로그램: 파일이 저장 장치에 저장되어 있지만 메모리에는 올라가 있지 않은 정적인 상태를 말한다. 프로세스: 운영체제로부터 자원을 할당받은 작업의 단위. 스레드: 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위. 💿 Thread &amp; Process Thread는...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Spring-Web/" class="btn btn-outline-primary"><p>Spring-Web</p></a> <a href="/posts/Thread-Process/" class="btn btn-outline-primary"><p>Thread Process</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/dl/">dl</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/process/">process</a> <a class="post-tag" href="/tags/computerarchitecture/">computerarchitecture</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://JeongJin984.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
